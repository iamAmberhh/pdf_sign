{"version":3,"sources":["all.js"],"names":["footer","document","querySelector","window","location","pathname","classList","add","timeline","querySelectorAll","pages","timelineCheck","forEach","item","index","p","firstChild","nextSibling","span","lastElementChild","remove","tag","addEventListener","e","currentTag","target","closest","tags","tagsBlock","i","getAttribute","dataset","data","dropbox","dragenter","dragover","drop","stopPropagation","preventDefault","dt","dataTransfer","files","fileObj","handleFiles","name","split","size","length","fileReader","FileReader","readAsArrayBuffer","result","typedarray","Uint8Array","localStorage","setItem","obj","year","lastModifiedDate","getFullYear","month","getMonth","date","getDate","push","noUpload","fileTable","renderUpload","fileTableBody","str","innerHTML","nextStepBtn","setAttribute","Base64Prefix","pdfjsLib","GlobalWorkerOptions","workerSrc","readBlob","blob","Promise","resolve","reject","reader","readAsDataURL","printPDF","pdfData","atob","substring","getDocument","promise","pdfDoc","getPage","pdfPage","viewport","getViewport","scale","devicePixelRatio","canvas","createElement","context","getContext","height","width","renderContext","canvasContext","renderTask","render","then","pdfToImage","fabric","Image","id","scaleX","scaleY","Canvas","requestRenderAll","pdfImage","setWidth","setHeight","setBackgroundImage","renderAll","bind"],"mappings":"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","file":"all.js","sourcesContent":["const footer = document.querySelector(\".footer\");\nif (window.location.pathname == \"/index.html\") {\n  footer.classList.add(\"d-none\");\n}\n\n// 下bar 時間軸\nconst timeline = document.querySelectorAll(\".timeline li\");\nlet pages = 0;\nif (window.location.pathname == \"/signup.html\") {\n  pages = 1;\n  timelineCheck();\n}\nif (window.location.pathname == \"/download.html\") {\n  pages = 2;\n  timelineCheck();\n}\n\nfunction timelineCheck() {\n  timeline.forEach((item, index) => {\n    let p = item.firstChild.nextSibling;\n    let span = item.lastElementChild;\n    if (index < pages) {\n      p.classList.remove(\"text-primary\", \"timeline-bar-current\");\n      p.classList.add(\"text-secondary\", \"timeline-bar-done\");\n      span.classList.remove(\"timeline-spot-current\");\n      span.classList.add(\"timeline-spot-done\");\n    }\n    if (index == pages) {\n      p.classList.remove(\"text-darkgray\");\n      p.classList.add(\"text-primary\");\n      span.classList.add(\"timeline-spot-current\");\n    }\n  });\n}\n\n// 上傳文件切換\nconst tag = document.querySelector(\".tag-bar\");\nif (tag) {\n  tag.addEventListener(\"click\", function (e) {\n    let currentTag = e.target.closest(\"li\");\n    let tags = document.querySelectorAll(\".tags\");\n    let tagsBlock = document.querySelectorAll(\".tags-block\");\n    tags.forEach((i) => {\n      i.classList.remove(\"tags-active\");\n    });\n    currentTag.classList.add(\"tags-active\");\n    tagsBlock.forEach((i) => {\n      i.classList.add(\"d-none\");\n      if (`#${i.getAttribute(\"id\")}` === currentTag.dataset.target) {\n        i.classList.remove(\"d-none\");\n      }\n    });\n  });\n}\n\n// 拖曳檔案上傳\nlet data = [];\nlet dropbox = document.querySelector(\".outline\");\nif (dropbox) {\n  dropbox.addEventListener(\"dragenter\", dragenter, false);\n  dropbox.addEventListener(\"dragover\", dragover, false);\n  dropbox.addEventListener(\"drop\", drop, false);\n}\n\nfunction dragenter(e) {\n  e.stopPropagation();\n  e.preventDefault();\n}\nfunction dragover(e) {\n  e.stopPropagation();\n  e.preventDefault();\n}\nfunction drop(e) {\n  e.stopPropagation();\n  e.preventDefault();\n  let dt = e.dataTransfer;\n  let files = dt.files;\n  let fileObj = files[0];\n  // console.log(files)\n  // console.log(files[0])\n  handleFiles(files,fileObj);\n}\n\n\nfunction handleFiles(files,fileObj) {\n  if (files[0].name.split(\".\")[1] != \"pdf\") {\n    // Swal.fire(\"您的檔案類型不是PDF檔!\");\n    return;\n  }\n  if (files[0].size > 10485760) {\n    // Swal.fire({\n    //   title: \"error!\",\n    //   text: \"您的檔案太大了!\",\n    //   icon: \"error\",\n    //   confirmButtonText: \"重新上傳\",\n    // });\n    return;\n  }\n  if (files.length > 0) {\n\n    let fileReader = new FileReader();\n\n    fileReader.readAsArrayBuffer(fileObj);\n\n    fileReader.addEventListener(\"load\", function () {\n      const result = fileReader.result;\n      // console.log(result)\n      const typedarray = new Uint8Array(fileReader.result);\n      // console.log(typedarray)\n      localStorage.setItem(\"pdf\", `${result}`);\n      localStorage.setItem(\"test\", `${typedarray}`);\n    });\n\n    let obj = {};\n    obj.name = files[0].name;\n    obj.year = files[0].lastModifiedDate.getFullYear();\n    obj.month = files[0].lastModifiedDate.getMonth() + 1;\n    obj.date = files[0].lastModifiedDate.getDate();\n    data.push(obj);\n\n    noUpload.classList.add(\"d-none\");\n    fileTable.classList.remove(\"d-none\");\n\n    // fileReader.readAsText(files[0]); // 讀取上傳的檔案\n\n    // Swal.fire({\n    //   title: \"success!\",\n    //   text: \"上傳成功\",\n    //   icon: \"success\",\n    //   confirmButtonText: \"繼續上傳\",\n    // });\n    renderUpload();\n  }\n}\n// const fileUploader = document.querySelector(\".select\");\n// let result2;\n// fileUploader.addEventListener(\"change\", (e) => {\n//     // 副檔名檢查\n//     if (fileUploader.files[0].name.split(\".\")[1] != \"pdf\") {\n//         return;\n//     }\n//     if (fileUploader.files.length > 0) {\n//         let reader = new FileReader();\n//         reader.addEventListener(\"load\", function () {\n//             // result2 為讀檔的結果\n//             result2 = reader.result;\n//             console.log(result2);\n//             // 資料處理\n\n//         });\n//         reader.readAsText(fileUploader.files[0]);\n//     }\n// });\n\nconst fileTable = document.querySelector(\".has-file\");\nconst fileTableBody = document.querySelector(\".table-body\");\nfunction renderUpload() {\n  let str = \"\";\n  data.forEach((i) => {\n    str += `<tr>\n    <th scope=\"row\"><a href=\"#\">${i.name}</a></th>\n    <td><a href=\"#\">${i.year}/${i.month}/${i.date}</a></td>\n    <td class=\"d-none d-md-block\"><a href=\"#\">--</a></td>\n</tr>`;\n  });\n  fileTableBody.innerHTML = str;\n}\n\nconst nextStepBtn = document.querySelector(\"[data-next]\");\nif (fileTableBody) {\n  fileTableBody.addEventListener(\"click\", function (e) {\n    e.target.closest(\"tr\").classList.add(\"bg-light\");\n    nextStepBtn.classList.remove(\"disabled\", \"btn-disabled\");\n    nextStepBtn.classList.add(\"btn-secondary\");\n    nextStepBtn.setAttribute(\"href\", \"signup.html\");\n  });\n}\n\nconst noUpload = document.querySelector(\".no-file\");\nif (noUpload) {\n  if (data.length == 0) {\n    noUpload.classList.remove(\"d-none\");\n    fileTable.classList.add(\"d-none\");\n  }\n}\n\n\n\n\n\n// PDF渲染成畫布\n\n// const selectFile = document.querySelector(\".select\");\n// pdfjsLib.GlobalWorkerOptions.workerSrc = \"https://mozilla.github.io/pdf.js/build/pdf.worker.js\";\n// const canvas = document.querySelector(\"#canvas\");\n// const ctx = canvas.getContext(\"2d\");\n\n// function renderPDF(data) {\n//   //  非同步 取得PDF檔案 進到then\n//   pdfjsLib.getDocument(data).promise.then((doc) => {\n//     //  選擇檔案的第一頁，成功再進到then\n//     doc.getPage(1).then((page) => {\n//       //  取得檔案的大小，並設為視口大小\n//       const viewport = page.getViewport({ scale: 1 });\n//       //   讓畫布和視口(檔案)大小一樣\n//       canvas.width = viewport.width;\n//       canvas.height = viewport.height;\n//       //   渲染頁面\n//       page.render({\n//         canvasContext: ctx,\n//         viewport: viewport\n//       });\n//     });\n//   });\n// }\n\n// if(selectFile){\n//   selectFile.addEventListener(\"change\", (e) => {\n//     if (e.target.files[0] === undefined) return;\n//     const file = e.target.files[0];\n//     const fileReader = new FileReader();\n//     fileReader.readAsArrayBuffer(file);\n//     fileReader.addEventListener(\"load\", () => {\n//       // 獲取readAsArrayBuffer產生的結果，並用來渲染PDF\n//       const typedarray = new Uint8Array(fileReader.result);\n//       renderPDF(typedarray);\n//     });\n//   });\n// }\n\nconst Base64Prefix = \"data:application/pdf;base64,\";\nconst add = document.querySelector(\".add\");\npdfjsLib.GlobalWorkerOptions.workerSrc = \"https://mozilla.github.io/pdf.js/build/pdf.worker.js\";\n\n// 使用原生 FileReader 轉檔\nfunction readBlob(blob) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.addEventListener(\"load\", () => resolve(reader.result));\n    reader.addEventListener(\"error\", reject);\n    reader.readAsDataURL(blob);\n  });\n}\n\nasync function printPDF(pdfData) {\n\n  // 將檔案處理成 base64\n  pdfData = await readBlob(pdfData);\n\n  // 將 base64 中的前綴刪去，並進行解碼\n  const data = atob(pdfData.substring(Base64Prefix.length));\n\n  // 利用解碼的檔案，載入 PDF 檔及第一頁\n  const pdfDoc = await pdfjsLib.getDocument({ data }).promise;\n  const pdfPage = await pdfDoc.getPage(1);\n\n  // 設定尺寸及產生 canvas\n  const viewport = pdfPage.getViewport({ scale: window.devicePixelRatio });\n  const canvas = document.createElement(\"canvas\");\n  const context = canvas.getContext(\"2d\");\n\n  // 設定 PDF 所要顯示的寬高及渲染\n  canvas.height = viewport.height;\n  canvas.width = viewport.width;\n  const renderContext = {\n    canvasContext: context,\n    viewport,\n  };\n  const renderTask = pdfPage.render(renderContext);\n\n  // 回傳做好的 PDF canvas\n  return renderTask.promise.then(() => canvas);\n}\n\nasync function pdfToImage(pdfData) {\n\n  // 設定 PDF 轉為圖片時的比例\n  const scale = 1 / window.devicePixelRatio;\n\n  // 回傳圖片\n  return new fabric.Image(pdfData, {\n    id: \"renderPDF\",\n    scaleX: scale,\n    scaleY: scale,\n  });\n}\n\n// 此處 canvas 套用 fabric.js\nconst canvas = new fabric.Canvas(\"canvas\");\n\ndocument.querySelector(\".select\").addEventListener(\"change\", async function(e){\n  canvas.requestRenderAll();\n  const pdfData = await printPDF(e.target.files[0]).promise;\n  const pdfImage = await pdfToImage(pdfData).promise;\n\n  // 透過比例設定 canvas 尺寸\n  canvas.setWidth(pdfImage.width / window.devicePixelRatio);\n  canvas.setHeight(pdfImage.height / window.devicePixelRatio);\n\n  // 將 PDF 畫面設定為背景\n  canvas.setBackgroundImage(pdfImage, canvas.renderAll.bind(canvas));\n});\n"]}